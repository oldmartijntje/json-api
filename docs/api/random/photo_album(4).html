<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal Photo Album</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: #300a24;
            color: #ffffff;
            overflow: hidden;
            height: 100vh;
        }

        .terminal-container {
            display: flex;
            height: 100vh;
        }

        .terminal {
            flex: 1;
            background: #300a24;
            border: 1px solid #5c2d3e;
            border-radius: 6px;
            margin: 10px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(244, 94, 132, 0.3);
        }

        .terminal-header {
            background: linear-gradient(to bottom, #4a4a4a, #2d2d2d);
            padding: 8px 12px;
            border-bottom: 1px solid #5c2d3e;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-radius: 6px 6px 0 0;
        }

        .window-controls {
            display: flex;
            gap: 6px;
        }

        .control-btn {
            width: 13px;
            height: 13px;
            border-radius: 50%;
            border: 1px solid rgba(0,0,0,0.3);
            cursor: pointer;
            position: relative;
        }

        .close { 
            background: linear-gradient(to bottom, #ff5f56, #e33e32);
        }
        .minimize { 
            background: linear-gradient(to bottom, #ffbd2e, #de9e00);
        }
        .maximize { 
            background: linear-gradient(to bottom, #27ca3f, #1aaa2b);
        }

        .control-btn:hover {
            filter: brightness(1.1);
        }

        .terminal-title {
            color: #ffffff;
            font-size: 13px;
            font-weight: 400;
            text-shadow: 0 1px 0 rgba(0,0,0,0.5);
        }

        .terminal-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #300a24;
        }

        .terminal-content {
            display: flex;
            height: 100%;
        }

        .command-area {
            flex: 1;
            padding-right: 20px;
            overflow-y: auto;
        }

        .photo-viewer {
            width: 400px;
            background: #2d1b24;
            border: 1px solid #5c2d3e;
            border-radius: 6px;
            padding: 15px;
            margin-left: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }

        .line {
            margin-bottom: 5px;
            word-wrap: break-word;
        }

        .prompt {
            color: #8ae234;
            font-weight: 500;
        }

        .user-input {
            color: #ffffff;
        }

        .error {
            color: #ff6c6b;
        }

        .success {
            color: #98d982;
        }

        .info {
            color: #51afef;
        }

        .warning {
            color: #ecbe7b;
        }

        .photo-display {
            max-width: 100%;
            max-height: 300px;
            object-fit: contain;
            border: 1px solid #5c2d3e;
            border-radius: 6px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .photo-info {
            width: 100%;
            font-size: 12px;
            color: #ffffff;
        }

        .photo-meta {
            margin-bottom: 8px;
            padding: 8px;
            background: #2d1b24;
            border: 1px solid #5c2d3e;
            border-radius: 4px;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
        }

        .input-line {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .terminal-input {
            background: transparent;
            border: none;
            color: #ffffff;
            font-family: inherit;
            font-size: 14px;
            outline: none;
            flex: 1;
            margin-left: 5px;
        }

        .cursor {
            animation: blink 1s infinite;
            color: #ffffff;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .ascii-art {
            color: #8ae234;
            font-size: 10px;
            line-height: 1;
            white-space: pre;
            margin: 10px 0;
        }

        .command-help {
            color: #666;
            font-size: 12px;
            margin-left: 20px;
        }

        .file-listing {
            color: #51afef;
            margin-left: 20px;
        }

        .file-item {
            margin: 2px 0;
            cursor: pointer;
            padding: 2px 5px;
            border-radius: 3px;
            transition: background 0.2s;
        }

        .file-item:hover {
            background: #2d1b24;
        }

        .directory {
            color: #51afef;
            font-weight: bold;
        }

        .image-file {
            color: #c678dd;
        }

        .loading-spinner {
            color: #8ae234;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 1200px) {
            .terminal-content {
                flex-direction: column;
            }
            
            .photo-viewer {
                width: 100%;
                margin-left: 0;
                margin-top: 20px;
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <div class="terminal">
            <div class="terminal-header">
                <div class="window-controls">
                    <button class="control-btn close"></button>
                    <button class="control-btn minimize"></button>
                    <button class="control-btn maximize"></button>
                </div>
                <div class="terminal-title">photo-album-terminal v1.0.0</div>
                <div></div>
            </div>
            <div class="terminal-body">
                <div class="terminal-content">
                    <div class="command-area">
                        <div id="output"></div>
                        <div class="input-line">
                            <span class="prompt">user@photo-album:~$</span>
                            <input type="text" class="terminal-input" id="terminalInput" autocomplete="off" spellcheck="false">
                            <span class="cursor">|</span>
                        </div>
                    </div>
                    <div class="photo-viewer" id="photoViewer">
                        <div class="ascii-art">
   ╔═══════════════════════╗
   ║      PHOTO VIEWER     ║
   ║                       ║
   ║   Use 'view <id>' to  ║
   ║   display a photo     ║
   ║                       ║
   ║   Type 'help' for     ║
   ║   available commands  ║
   ╚═══════════════════════╝
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TerminalPhotoAlbum {
            constructor() {
                this.photos = [];
                this.currentDirectory = '/photos';
                this.history = [];
                this.historyIndex = -1;
                this.output = document.getElementById('output');
                this.input = document.getElementById('terminalInput');
                this.photoViewer = document.getElementById('photoViewer');
                this.isLoading = false;
                
                this.commands = {
                    'help': this.showHelp.bind(this),
                    'ls': this.listFiles.bind(this),
                    'list': this.listFiles.bind(this),
                    'view': this.viewPhoto.bind(this),
                    'cat': this.viewPhoto.bind(this),
                    'info': this.showPhotoInfo.bind(this),
                    'search': this.searchPhotos.bind(this),
                    'grep': this.searchPhotos.bind(this),
                    'count': this.countPhotos.bind(this),
                    'wc': this.countPhotos.bind(this),
                    'recent': this.showRecent.bind(this),
                    'reload': this.loadPhotos.bind(this),
                    'clear': this.clearScreen.bind(this),
                    'pwd': this.showCurrentDir.bind(this),
                    'whoami': this.showUser.bind(this),
                    'date': this.showDate.bind(this),
                    'uptime': this.showUptime.bind(this),
                    'neofetch': this.showSystemInfo.bind(this),
                    'exit': this.exitTerminal.bind(this),
                    'sudo': this.sudoCommand.bind(this)
                };
                
                this.startTime = Date.now();
                this.initializeTerminal();
                this.loadPhotos();
            }

            initializeTerminal() {
                this.input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        this.processCommand();
                    } else if (e.key === 'ArrowUp') {
                        this.navigateHistory(-1);
                        e.preventDefault();
                    } else if (e.key === 'ArrowDown') {
                        this.navigateHistory(1);
                        e.preventDefault();
                    } else if (e.key === 'Tab') {
                        this.autoComplete();
                        e.preventDefault();
                    }
                });

                this.input.focus();
                this.addOutput('Welcome to Photo Album Terminal v1.0.0', 'success');
                this.addOutput('Type "help" for available commands', 'info');
                this.addOutput('Loading photos...', 'info');
            }

            async loadPhotos() {
                if (this.isLoading) return;
                this.isLoading = true;
                
                try {
                    const response = await fetch('https://api.oldmartijntje.nl/projectData/getProjectData?projectId=pictureAlbumPics');
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    this.photos = data.projectData || [];
                    
                    // Sort by date
                    this.photos.sort((a, b) => {
                        const dateA = new Date(a.attributes.datetime || '1970-01-01');
                        const dateB = new Date(b.attributes.datetime || '1970-01-01');
                        return dateB - dateA;
                    });
                    
                    this.addOutput(`✓ Successfully loaded ${this.photos.length} photos`, 'success');
                    this.addOutput('Type "ls" to list all photos', 'info');
                    
                } catch (error) {
                    this.addOutput(`✗ Error loading photos: ${error.message}`, 'error');
                    this.addOutput('Type "reload" to try again', 'warning');
                } finally {
                    this.isLoading = false;
                }
            }

            processCommand() {
                const command = this.input.value.trim();
                if (!command) return;
                
                this.addOutput(`user@photo-album:~$ ${command}`, 'user-input');
                this.history.push(command);
                this.historyIndex = this.history.length;
                
                const [cmd, ...args] = command.split(' ');
                
                if (this.commands[cmd]) {
                    this.commands[cmd](args);
                } else {
                    this.addOutput(`bash: ${cmd}: command not found`, 'error');
                    this.addOutput('Type "help" for available commands', 'info');
                }
                
                this.input.value = '';
                this.scrollToBottom();
            }

            showHelp() {
                this.addOutput('Available commands:', 'info');
                this.addOutput('');
                this.addOutput('  help              Show this help message', 'info');
                this.addOutput('  ls, list          List all photos', 'info');
                this.addOutput('  view <id>         Display photo by ID', 'info');
                this.addOutput('  info <id>         Show detailed photo information', 'info');
                this.addOutput('  search <term>     Search photos by marker or subtext', 'info');
                this.addOutput('  recent [n]        Show n most recent photos (default: 5)', 'info');
                this.addOutput('  count             Show total photo count', 'info');
                this.addOutput('  reload            Reload photos from API', 'info');
                this.addOutput('  clear             Clear terminal screen', 'info');
                this.addOutput('  pwd               Show current directory', 'info');
                this.addOutput('  whoami            Show current user', 'info');
                this.addOutput('  date              Show current date and time', 'info');
                this.addOutput('  uptime            Show system uptime', 'info');
                this.addOutput('  neofetch          Show system information', 'info');
                this.addOutput('  exit              Close terminal', 'info');
                this.addOutput('');
                this.addOutput('Navigation:', 'info');
                this.addOutput('  ↑/↓ arrows        Navigate command history', 'info');
                this.addOutput('  Tab               Auto-complete commands', 'info');
            }

            listFiles() {
                if (this.photos.length === 0) {
                    this.addOutput('No photos found. Type "reload" to refresh.', 'warning');
                    return;
                }
                
                this.addOutput('total ' + this.photos.length, 'info');
                this.addOutput('');
                this.photos.forEach((photo, index) => {
                    const date = new Date(photo.attributes.datetime || '1970-01-01');
                    const dateStr = date.toLocaleDateString('en-US', {
                        month: 'short',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    const marker = photo.attributes.marker || 'untitled';
                    const size = Math.floor(Math.random() * 9000) + 1000;
                    const permissions = photo.attributes.hidden ? '-rw-------' : '-rw-r--r--';
                    const paddedId = index.toString().padStart(3, '0');
                    const filename = 'photo_' + paddedId + '.jpg';
                    
                    this.addOutput(permissions + ' 1 user user ' + size.toString().padStart(6) + ' ' + dateStr + ' ' + filename, 'file-listing');
                });
                this.addOutput('');
                this.addOutput('Use "view <id>" to display a photo', 'info');
            }

            viewPhoto(args) {
                if (!args.length) {
                    this.addOutput('Usage: view <photo_id>', 'error');
                    return;
                }
                
                const id = parseInt(args[0]);
                if (isNaN(id) || id < 0 || id >= this.photos.length) {
                    this.addOutput(`Error: Photo ID ${args[0]} not found`, 'error');
                    this.addOutput(`Valid range: 0-${this.photos.length - 1}`, 'info');
                    return;
                }
                
                const photo = this.photos[id];
                this.displayPhotoInViewer(photo, id);
                this.addOutput(`Displaying photo ${id}: ${photo.attributes.marker || 'untitled'}`, 'success');
            }

            displayPhotoInViewer(photo, id) {
                const date = new Date(photo.attributes.datetime || '1970-01-01').toLocaleString();
                
                this.photoViewer.innerHTML = `
                    <img src="${photo.attributes.imgur}" alt="Photo ${id}" class="photo-display" onerror="this.style.display='none'">
                    <div class="photo-info">
                        <div class="photo-meta">
                            <strong>ID:</strong> ${id}<br>
                            <strong>Marker:</strong> ${photo.attributes.marker || 'none'}<br>
                            <strong>Date:</strong> ${date}
                        </div>
                        ${photo.attributes.subtext ? `<div class="photo-meta"><strong>Description:</strong><br>${photo.attributes.subtext}</div>` : ''}
                    </div>
                `;
            }

            showPhotoInfo(args) {
                if (!args.length) {
                    this.addOutput('Usage: info <photo_id>', 'error');
                    return;
                }
                
                const id = parseInt(args[0]);
                if (isNaN(id) || id < 0 || id >= this.photos.length) {
                    this.addOutput(`Error: Photo ID ${args[0]} not found`, 'error');
                    return;
                }
                
                const photo = this.photos[id];
                const date = new Date(photo.attributes.datetime || '1970-01-01').toLocaleString();
                
                this.addOutput(`Photo Information:`, 'info');
                this.addOutput('');
                this.addOutput('  ID: ' + id, 'info');
                this.addOutput('  Marker: ' + (photo.attributes.marker || 'none'), 'info');
                this.addOutput('  Subtext: ' + (photo.attributes.subtext || 'none'), 'info');
                this.addOutput('  Date: ' + date, 'info');
                this.addOutput('  URL: ' + photo.attributes.imgur, 'info');
                this.addOutput('  Hidden: ' + photo.attributes.hidden, 'info');
                this.addOutput('  MongoDB ID: ' + photo._id, 'info');
            }

            searchPhotos(args) {
                if (!args.length) {
                    this.addOutput('Usage: search <search_term>', 'error');
                    return;
                }
                
                const term = args.join(' ').toLowerCase();
                const matches = this.photos.filter((photo, index) => {
                    const marker = (photo.attributes.marker || '').toLowerCase();
                    const subtext = (photo.attributes.subtext || '').toLowerCase();
                    return marker.includes(term) || subtext.includes(term);
                });
                
                if (matches.length === 0) {
                    this.addOutput(`No photos found matching "${term}"`, 'warning');
                } else {
                    this.addOutput(`Found ${matches.length} photos matching "${term}":`, 'success');
                    matches.forEach(photo => {
                        const id = this.photos.indexOf(photo);
                        const marker = photo.attributes.marker || 'untitled';
                        this.addOutput(`  ${id}: ${marker}`, 'file-listing');
                    });
                }
            }

            showRecent(args) {
                const count = args.length ? parseInt(args[0]) : 5;
                const recent = this.photos.slice(0, Math.min(count, this.photos.length));
                
                this.addOutput(`${recent.length} most recent photos:`, 'info');
                recent.forEach((photo, index) => {
                    const date = new Date(photo.attributes.datetime || '1970-01-01').toLocaleDateString();
                    const marker = photo.attributes.marker || 'untitled';
                    this.addOutput(`  ${index}: ${marker} (${date})`, 'file-listing');
                });
            }

            countPhotos() {
                this.addOutput(`Total photos: ${this.photos.length}`, 'info');
            }

            clearScreen() {
                this.output.innerHTML = '';
            }

            showCurrentDir() {
                this.addOutput('/home/user/photos', 'info');
            }

            showUser() {
                this.addOutput('user', 'info');
            }

            showDate() {
                this.addOutput(new Date().toString(), 'info');
            }

            showUptime() {
                const uptime = Date.now() - this.startTime;
                const minutes = Math.floor(uptime / 60000);
                const seconds = Math.floor((uptime % 60000) / 1000);
                this.addOutput(`up ${minutes}m ${seconds}s`, 'info');
            }

            showSystemInfo() {
                const info = `
                    ██████╗ ██╗  ██╗ ██████╗ ████████╗ ██████╗ 
                    ██╔══██╗██║  ██║██╔═══██╗╚══██╔══╝██╔═══██╗
                    ██████╔╝███████║██║   ██║   ██║   ██║   ██║
                    ██╔═══╝ ██╔══██║██║   ██║   ██║   ██║   ██║
                    ██║     ██║  ██║╚██████╔╝   ██║   ╚██████╔╝
                    ╚═╝     ╚═╝  ╚═╝ ╚═════╝    ╚═╝    ╚═════╝ 
                    
                    OS: PhotoAlbum Terminal v1.0.0
                    Kernel: JavaScript Engine
                    Uptime: ${Math.floor((Date.now() - this.startTime) / 60000)}m
                    Photos: ${this.photos.length}
                    Memory: ${Math.floor(Math.random() * 1000)}MB / 2048MB
                `;
                this.addOutput(info, 'success');
            }

            exitTerminal() {
                this.addOutput('Goodbye!', 'success');
                setTimeout(() => {
                    window.close();
                }, 1000);
            }

            sudoCommand(args) {
                this.addOutput('sudo: You are not in the sudoers file. This incident will be reported.', 'error');
            }

            navigateHistory(direction) {
                if (this.history.length === 0) return;
                
                this.historyIndex += direction;
                if (this.historyIndex < 0) this.historyIndex = 0;
                if (this.historyIndex >= this.history.length) this.historyIndex = this.history.length - 1;
                
                this.input.value = this.history[this.historyIndex] || '';
            }

            autoComplete() {
                const input = this.input.value;
                const commands = Object.keys(this.commands);
                const matches = commands.filter(cmd => cmd.startsWith(input));
                
                if (matches.length === 1) {
                    this.input.value = matches[0];
                } else if (matches.length > 1) {
                    this.addOutput(`Possible completions: ${matches.join(', ')}`, 'info');
                }
            }

            addOutput(text, className = '') {
                const line = document.createElement('div');
                line.className = `line ${className}`;
                line.textContent = text;
                this.output.appendChild(line);
            }

            scrollToBottom() {
                const commandArea = document.querySelector('.command-area');
                commandArea.scrollTop = commandArea.scrollHeight;
            }
        }

        // Initialize terminal when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new TerminalPhotoAlbum();
        });
    </script>
</body>
</html>